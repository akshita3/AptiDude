CREATE DATABASE APTIDUDE;

CREATE TABLE ROLE_MST(ROLEID SERIAL PRIMARY KEY, ROLENAME TEXT NOT NULL, DESCRIPTION TEXT NOT NULL);

CREATE TABLE USER_MST(UID SERIAL PRIMARY KEY, EMAILID TEXT NOT NULL, PASSWORD TEXT NOT NULL, FIRSTNAME TEXT NOT NULL, SECONDNAME TEXT, POINTS INT DEFAULT(0), ATTEMPTEDQSTNS INT DEFAULT(0), ROLEID INT REFERENCES ROLE_MST(ROLEID) ON DELETE CASCADE);

CREATE TABLE RIGHT_MST(RIGHTID SERIAL PRIMARY KEY, RIGHTNAME TEXT NOT NULL, SCREENNAME TEXT NOT NULL);

CREATE TABLE ROLE_RIGHT_MAPPING(MAPID SERIAL PRIMARY KEY, ROLEID INT REFERENCES ROLE_MST(ROLEID) ON DELETE CASCADE, RIGHTID INT REFERENCES RIGHT_MST(RIGHTID) ON DELETE CASCADE);

CREATE TABLE TOPIC_MST(TOPICID SERIAL PRIMARY KEY, TOPICNAME TEXT NOT NULL, DESCRIPTION TEXT NOT NULL);

CREATE TABLE QSTN_MST(QID SERIAL PRIMARY KEY, QSTN TEXT NOT NULL, OPTIONS TEXT[] NOT NULL, ANSWER TEXT NOT NULL, TOPICID INT REFERENCES TOPIC_MST(TOPICID) ON DELETE CASCADE);

INSERT INTO ROLE_MST(ROLENAME,DESCRIPTION) VALUES('Admin','This is admin');
INSERT INTO ROLE_MST(ROLENAME,DESCRIPTION) VALUES('User','This is user');

INSERT INTO RIGHT_MST(RIGHTNAME,SCREENNAME) VALUES('Add Admin','addAdmin.jsp');
INSERT INTO RIGHT_MST(RIGHTNAME,SCREENNAME) VALUES('Add Question','addQstn.jsp');
INSERT INTO RIGHT_MST(RIGHTNAME,SCREENNAME) VALUES('Remove Question','delQstn.jsp');
INSERT INTO RIGHT_MST(RIGHTNAME,SCREENNAME) VALUES('Take Test','takeTest.jsp');
INSERT INTO RIGHT_MST(RIGHTNAME,SCREENNAME) VALUES('Update Profile','updateProfile.jsp');

INSERT INTO ROLE_RIGHT_MAPPING(ROLEID,RIGHTID) VALUES(1,1);
INSERT INTO ROLE_RIGHT_MAPPING(ROLEID,RIGHTID) VALUES(1,2);
INSERT INTO ROLE_RIGHT_MAPPING(ROLEID,RIGHTID) VALUES(1,3);
INSERT INTO ROLE_RIGHT_MAPPING(ROLEID,RIGHTID) VALUES(1,5);
INSERT INTO ROLE_RIGHT_MAPPING(ROLEID,RIGHTID) VALUES(2,4);
INSERT INTO ROLE_RIGHT_MAPPING(ROLEID,RIGHTID) VALUES(2,5);

INSERT INTO USER_MST(EMAILID,PASSWORD,FIRSTNAME,ROLEID) VALUES('admin','admin','Administrator',1);




